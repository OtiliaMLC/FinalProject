{% extends "layout.html" %}

{% block title %}Dashboard - Bootstrap Budget Tracker{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <h2>Your Marketing Campaigns</h2>
        <a href="{{ url_for('create_campaign') }}" class="btn btn-primary">+ Create New Campaign</a>
    </div>

    {% if campaigns %}
        <div class="campaigns-grid">
            {% for campaign in campaigns %}
                <div class="campaign-card {% if campaign.budget_used_percent >= 80 %}budget-alert{% endif %}">
                    <div class="campaign-header">
                        <h3>{{ campaign.name }}</h3>
                        <span class="badge badge-{{ campaign.status }}">{{ campaign.status }}</span>
                    </div>
                    
                    <div class="campaign-info">
                        <p><strong>Channel:</strong> {{ campaign.channel }}</p>
                        <p><strong>Budget:</strong> ${{ "%.2f"|format(campaign.budget) }}</p>
                        <p><strong>Spent:</strong> ${{ "%.2f"|format(campaign.total_spend) }}</p>
                        <p><strong>Period:</strong> {{ campaign.start_date }} to {{ campaign.end_date }}</p>
                    </div>
                    
                    <div class="campaign-metrics">
                        <div class="metric">
                            <span class="metric-value">{{ campaign.total_impressions }}</span>
                            <span class="metric-label">Impressions</span>
                        </div>
                        <div class="metric">
                            <span class="metric-value">{{ campaign.total_clicks }}</span>
                            <span class="metric-label">Clicks</span>
                        </div>
                        <div class="metric">
                            <span class="metric-value">{{ campaign.total_conversions }}</span>
                            <span class="metric-label">Conversions</span>
                        </div>
                    </div>
                    
                    <div class="campaign-performance">
                        <div class="roi-display">
                            <span class="roi-label">ROI:</span>
                            <span class="roi-value {% if campaign.roi > 0 %}positive{% else %}negative{% endif %}">
                                {{ "%.2f"|format(campaign.roi) }}%
                            </span>
                        </div>
                        
                        <div class="budget-bar">
                            <div class="budget-bar-fill" style="width: {{ campaign.budget_used_percent }}%"></div>
                        </div>
                        <p class="budget-text">Budget used: {{ "%.1f"|format(campaign.budget_used_percent) }}%</p>
                        
                        {% if campaign.budget_used_percent >= 80 %}
                            <p class="alert-warning">⚠️ Budget alert: You've used over 80% of your budget!</p>
                        {% endif %}
                    </div>
                    
                    <div class="campaign-actions">
                        <a href="{{ url_for('add_metrics', campaign_id=campaign.id) }}" class="btn btn-small">Add Metrics</a>
                        <a href="{{ url_for('edit_campaign', campaign_id=campaign.id) }}" class="btn btn-small">Edit</a>
                        <form method="POST" action="{{ url_for('delete_campaign', campaign_id=campaign.id) }}" style="display: inline;">
                            <button type="submit" class="btn btn-small btn-danger" onclick="return confirm('Are you sure you want to delete this campaign?')">Delete</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <h3>No campaigns yet!</h3>
            <p>Create your first marketing campaign to start tracking performance and ROI.</p>
            <a href="{{ url_for('create_campaign') }}" class="btn btn-primary">Create Your First Campaign</a>
        </div>
    {% endif %}
</div>
{% endblock %}
